# Method used to determine appropriate noise masking method

# Prologue

## Data

Participants:
n = 42

Conditions:
n[c] = 2 × 2 = 4
{ button push, vocal response } × { stranger present, stranger not
present }

Collected data:
50 ~3" waveform files × participant × participated condition

## openSMILE: emobase.conf

To get an idea of what openSMILE was used with emobase.conf (openSMILE
configuration file for live emotion recognition base set of 988
features, 1st level functionals of low-level descriptors such as MFCC,
Pitch, LSP, ...) set of 150 or 200 waveform files (3 or 4 conditions
with 50 waveforms each) with each file lasting ~3 seconds.

## Random Trees

*TODO: write this section*

# Removing noise
Each 0:00:03 waveform begins with a beep. To remove these unwanted beeps,
0:00:0.16 was initially clipped from the beginning of each 0:00:03 waveform
file and the files for each condition per participant were concatenated :
each participant has a maximum of 4 (n[c]) ~0:02:30 waveform files.

# Testing options

## Proof of concept

To pilot noise masking options, `M00437100_vocal_no_long_no_beeps.wav` was
selected randomly from the subset of data files that included participants
without a SM diagnosis and in a stranger-not-present condition trial. The clips
listed in the trial blocks below were analyzed by openSMILE with the 
`emobase.conf` and `ComParE_2016.conf` configuration files using the default
parameters for each.

Three blocks of comparisons were made.

### Ambient noise in trial block

`ambient_noise_silenced`: A modified version of the original file was created
in Audacity in which a 2.5 second clip of ambient noise beginning at 25.864
seconds was removed.

This clip (`ambient_noise_silenced.wav`) was compared against `original.wav` &
the following modifications of itself:

`ambient_noise_replaced_with_clone`: a clone mask was created by copying a 2.5
second clip (from the same file beginning at 4.713 seconds) into a new audio
track, reversing this clip and appending the reversed clip to reach 5 seconds,
then repeating this pattern to reach the full 00:02:27.24 length of
`original.wav`, clipping the end to make the durations match. The 2.5 seconds
of this clone mask beginning at 25.864 seconds was mixed in to
`ambient_noise_silenced.wav` to create the file for this condition.

`ambient_noise_clone_throughout.wav`: the aforementioned clone mask was mixed
throughout the duration of `ambient_noise_silenced.wav` to create this
condition.

`ambient_noise_replaced_with_stretch.wav`: the half-second of ambient noise
immediately preceding the silenced 2.5 seconds in `ambient_noise_silenced.wav`
was stretched to fill the silence in this condition.

`ambient_noise_replaced_with_brownian`, `ambient_noise_replaced_with_pink`,
`ambient_noise_replaced_with_white`: brownian, pink, and white noise, 
respectively, were generated by Audacity to fill the 2.5 seconds of silence in
`ambient_noise_silenced.wav` to create these conditions.

`ambient_noise_replaced_with_timeshift.wav`: the 2.5 seconds of silence in 
`ambient_noise_silenced.wav` was simply deleted to create this condition.

### Ambient noise isolated

`original_only_ambient_noise.wav`: the 2.5 seconds of ambient noise removed
from `original.wav` to create `ambient_noise_silenced.wav` was used as the
baseline for this trial block.

`only_ambient_noise_replaced_with_clone.wav`: the 2.5 seconds of clone mask
mixed into `ambient_noise_replaced_with_clone.wav` was isolated for this
condition.

`only_ambient_noise_replaced_with_stretch.wav`: the stretched 2.5 second clip
used to fill the silence in `ambient_noise_replaced_with_stretch.wav` was
isolated for this condition.

`only_ambient_noise_replaced_with_brownian.wav`: 2.5 seconds of brownian noise
was generated by Audacity for this condition.

`only_ambient_noise_replaced_with_silence.wav`: 2.5 seconds of silence was
generated by Audacity for this condition.

### Actual noise in trial block

As in the ambient noise trial block, these clips were compared against
`original.wav`.

`noise_replaced_with_silence.wav`: 2.178 seconds beginning at 00:01:51.632
which included an audible cough were silenced to create this condition.

`noise_replaced_with_clone.wav`: the corresponding 2.178 second segment of the
clone mask used in the ambient noise trial block was mixed in to the silenced
section of `noise_replaced_with_silence.wav` to create this condition. 

`noise_clone_throughout.wav`: the entire clone mask used in the ambient noise
trial block was mixed in to `noise_replaced_with_silence.wav` to create this
condition.

`noise_replaced_with_timeshift.wav`: the silenced section of
`noise_replaced_with_silence.wav` was deleted to create this condition.

### Summary statistics

For
:   x = original
:   y = condition
:   condition = {ambient noise replaced with, noise replaced with}
:   ambient noise replaced with = {silence, clone, stretch, brownian, pink,
:   white, clone throughout}
:   noise replaced with = {silence, clone, clone throughout, timeshift}

v ∈ normalized values : 
∀ z ∈ w ∈ condition, z/√(Σ(x + w)²) = v

n ∈ normalized distances :
∀ v, |v - x| = n

d ∈ absolute distances :
∀ z ∈ w ∈ condition, |z - x| = d

r ∈ rank absolute distances : 
∀ d ∈ absolute distances, rank within {x, ∀ w ∈ condition}

Σ(x-v)² & Σ(x-z)² were calculated and ranked
ranks were summed and ranked and averaged (mean, median, and mode)

These outputs can all be found in the workbook `condition_comparison.xlsx`
with the final summary values on the worksheet `summary`.

# Removing noise again
0:00:0.16 proved to be insufficient to remove all of the beeping noises.
The noise removal procedure mentioned above was repeated on the original
soundfiles, this time removing 0:00:0.25 from each 0:00:03 waveform prior
to concatenation.
